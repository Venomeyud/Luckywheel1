<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>ä¸‰å‘¨å¹´å¿«ä¹ æ±ªé›¯ä¸“å±ç¤¼ç‰©è½¬ç›˜</title>
    <style>
        /* --- 1. å…¨å±€æ ·å¼ --- */
        body {
            font-family: -apple-system, BlinkMacSystemFont, "PingFang SC", "Helvetica Neue", sans-serif;
            background-color: #E6E6FA; 
            background-image: linear-gradient(135deg, #E6E6FA 0%, #B0C4DE 100%);
            background-size: cover; 
            background-position: center;
            background-repeat: no-repeat;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            margin: 0;
            overflow: hidden;
            color: #000;
        }
        
        body::before {
            content: ""; position: absolute; top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(255,255,255, 0.25); backdrop-filter: blur(5px); -webkit-backdrop-filter: blur(5px);
            z-index: -1;
        }

        /* --- 2. å¡ç‰‡å®¹å™¨ --- */
        .glass-card {
            background: rgba(255, 255, 255, 0.85);
            border-radius: 30px;
            padding: 30px 20px;
            width: 90%; max-width: 380px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            text-align: center;
            border: 1px solid rgba(255,255,255,0.6);
            backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px);
        }

        h1 { margin: 0; font-size: 24px; font-weight: 800; color: #1c1c1e; }
        .subtitle { margin-top: 8px; margin-bottom: 25px; font-size: 14px; color: #666; }

        /* --- 3. è½¬ç›˜å¤–å£³ --- */
        .wheel-wrapper {
            position: relative;
            width: 320px;
            height: 320px;
            margin: 0 auto 30px auto;
            filter: drop-shadow(0 10px 15px rgba(0,0,0,0.1));
        }

        /* æŒ‡é’ˆ */
        .pointer {
            position: absolute;
            top: -25px; left: 50%;
            transform: translateX(-50%);
            width: 40px; height: 50px;
            z-index: 50;
            background-image: url("data:image/svg+xml,%3Csvg width='40' height='50' viewBox='0 0 40 50' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M20 50L0 10C0 4.5 4.5 0 10 0H30C35.5 0 40 4.5 40 10L20 50Z' fill='%23FF3B30'/%3E%3C/svg%3E");
            background-size: contain; background-repeat: no-repeat;
        }

        /* --- 4. è½¬åŠ¨éƒ¨åˆ† --- */
        #spinner {
            width: 100%; height: 100%;
            position: relative;
            border-radius: 50%;
            border: 8px solid #fff; 
            box-sizing: border-box;
            background: #fff;
            overflow: hidden;
        }

        /* æ‰‡å½¢èƒŒæ™¯è‰² */
        .fan-bg { position: absolute; top: 0; right: 0; width: 50%; height: 50%; transform-origin: 0% 100%; }
        .fan-1, .fan-3, .fan-5 { background: #FFFBE6; } 
        .fan-2, .fan-4, .fan-6 { background: #FFDEE9; } 
        
        .fan-1 { transform: rotate(0deg) skewY(-30deg); }
        .fan-2 { transform: rotate(60deg) skewY(-30deg); }
        .fan-3 { transform: rotate(120deg) skewY(-30deg); }
        .fan-4 { transform: rotate(180deg) skewY(-30deg); }
        .fan-5 { transform: rotate(240deg) skewY(-30deg); }
        .fan-6 { transform: rotate(300deg) skewY(-30deg); }

        /* --- å†…å®¹å±‚ --- */
        .content-wrap { position: absolute; width: 100%; height: 100%; top: 0; left: 0; }
        .item { position: absolute; top: 50%; left: 50%; width: 0; height: 0; }
        
        .item-inner { 
            position: absolute; 
            top: -138px;  
            left: -50px; 
            width: 100px; 
            text-align: center; 
        }
        
        .item img { 
            width: 42px; height: 42px; 
            object-fit: contain; 
            display: block; 
            margin: 0 auto 3px auto;
            filter: drop-shadow(0 2px 2px rgba(0,0,0,0.1)); 
        }
        
        .item span { 
            display: block; 
            font-size: 13px; 
            line-height: 1.2; 
            font-weight: 900; 
            color: #333; 
            text-shadow: 1px 1px 0 rgba(255,255,255,0.9); 
        }

        /* --- ä¸­å¿ƒè§†é¢‘å®¹å™¨ --- */
        .center-circle {
            position: absolute;
            top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            width: 70px; height: 70px;
            background: #fff;
            border-radius: 50%;
            box-shadow: 0 4px 10px rgba(0,0,0,0.15);
            z-index: 10;
            display: flex; align-items: center; justify-content: center;
            overflow: hidden; 
            border: 3px solid #fff;
        }
        
        /* è§†é¢‘æ ·å¼é€‚é… */
        .center-bear-img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transform: scale(1.1); 
        }

        /* --- 5. æŒ‰é’® --- */
        #spinBtn {
            width: 80%; padding: 16px; border-radius: 20px; border: none;
            background: #007AFF; color: white; font-size: 18px; font-weight: bold;
            box-shadow: 0 8px 20px rgba(0, 122, 255, 0.3); cursor: pointer;
            transition: all 0.2s;
        }
        #spinBtn:active { transform: scale(0.96); }
        #spinBtn:disabled { background: #ccc; box-shadow: none; transform: none;}

        /* --- 6. å¼¹çª— --- */
        #modal {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.6); backdrop-filter: blur(5px); -webkit-backdrop-filter: blur(5px);
            z-index: 100; align-items: center; justify-content: center;
        }
        .modal-box {
            background: rgba(255,255,255,0.98); width: 75%; max-width: 300px;
            padding: 30px; border-radius: 25px; text-align: center;
            box-shadow: 0 20px 50px rgba(0,0,0,0.3);
            animation: pop 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        @keyframes pop { from{transform: scale(0.8); opacity: 0;} to{transform: scale(1); opacity: 1;} }
        
        #m-icon {
            width: 100px; height: 100px; object-fit: contain;
            margin: 10px auto; display: block;
        }

        /* --- CSSåŠ¨ç”»æ•ˆæœ --- */
        .anim-win { animation: pulseWin 1s infinite; }
        @keyframes pulseWin {
            0% { transform: scale(1); }
            50% { transform: scale(1.15) rotate(5deg); }
            100% { transform: scale(1); }
        }
        
        .anim-lose { animation: shakeLose 0.8s infinite ease-in-out; }
        @keyframes shakeLose {
            0% { transform: rotate(0deg); }
            25% { transform: rotate(-10deg); }
            50% { transform: rotate(0deg); }
            75% { transform: rotate(10deg); }
            100% { transform: rotate(0deg); }
        }
        
        .close-btn {
            background: #FF2D55; color: white; border: none; padding: 12px 30px;
            border-radius: 20px; font-weight: bold; margin-top: 20px; width: 100%; cursor: pointer;
            transition: background 0.3s;
        }
        
        /* ç‰ˆæœ¬æ ‡è®° */
        .version-tag {
            margin-top: 20px;
            font-size: 12px;
            color: #999;
            opacity: 0.8;
        }

    </style>
</head>
<body>

    <div class="glass-card">
        <h1>ä¸‰å‘¨å¹´å¿«ä¹<br>æ±ªé›¯ä¸“å±ç¤¼ç‰©è½¬ç›˜</h1>
        <div class="subtitle">è€å©†å¤§äººï¼Œè¿™æ¬¡çœ‹æ¸…æ¥šäº†å— â¤ï¸</div>

        <div class="wheel-wrapper">
            <div class="pointer"></div>
            <div id="spinner">
                
                <div class="fan-bg fan-1"></div>
                <div class="fan-bg fan-2"></div>
                <div class="fan-bg fan-3"></div>
                <div class="fan-bg fan-4"></div>
                <div class="fan-bg fan-5"></div>
                <div class="fan-bg fan-6"></div>

                <div class="content-wrap">
                    <div class="item" style="transform: rotate(30deg);"><div class="item-inner"><img src="https://img.alicdn.com/bao/uploaded/i4/2207692660945/O1CN0188939c20q6vXvQzXQ_!!2207692660945.jpg_300x300.jpg"><span>åŒ–å¦†å“/ä¿å…»å“</span></div></div>
                    <div class="item" style="transform: rotate(90deg);"><div class="item-inner"><img src="https://cdn-icons-png.flaticon.com/512/5726/5726678.png" style="filter: drop-shadow(0 0 5px gold); width:45px; height:45px;"><span style="color:#d63384">âœ¨ç¥ç§˜å¤§å¥–âœ¨</span></div></div>
                    <div class="item" style="transform: rotate(150deg);"><div class="item-inner"><img src="https://img.alicdn.com/bao/uploaded/i2/2213578026652/O1CN01h11B112CJIxZqGzXx_!!2213578026652.jpg_300x300.jpg"><span>çº¢åŒ…388</span></div></div>
                    <div class="item" style="transform: rotate(210deg);"><div class="item-inner"><img src="https://cdn-icons-png.flaticon.com/512/416/416835.png" style="opacity:0.5"><span style="color:#666">ä»€ä¹ˆéƒ½æ²¡æœ‰<br>(ç©ºæ°”)</span></div></div>
                    <div class="item" style="transform: rotate(270deg);"><div class="item-inner"><img src="https://img.alicdn.com/bao/uploaded/i3/2849132476/O1CN01a8899c1s511zXzXzX_!!2849132476.jpg_300x300.jpg"><span>è¡£è£¤/è£™å­/å†…è¡£</span></div></div>
                    <div class="item" style="transform: rotate(330deg);"><div class="item-inner"><img src="https://img.alicdn.com/bao/uploaded/i1/2200723576550/O1CN0188939c20q6vXvQzXQ_!!2200723576550.jpg_300x300.jpg"><span>ç¾½ç»’æœ</span></div></div>
                </div>

                <div class="center-circle">
                    <video class="center-bear-img" autoplay loop muted playsinline poster="https://cdn-icons-png.flaticon.com/512/3769/3769037.png">
                        <source src="bear.mp4" type="video/mp4">
                        <source src="bear.MP4" type="video/mp4">
                        <source src="e8eb6841ebbe9db9f8b6ff22b2e123d9_720w.cmfv" type="video/mp4">
                    </video>
                </div>
            </div>
        </div>

        <button id="spinBtn" onclick="startSpin()">å¼€å§‹æŠ½å¥–</button>
        <div class="version-tag">å½“å‰ç‰ˆæœ¬ï¼šè›‹ä»”æ´¾å¯¹éŸ³æ•ˆç‰ˆ ğŸµ</div>
    </div>

    <div id="modal">
        <div class="modal-box">
            <h2 id="m-title">ä¸­å¥–å•¦</h2>
            <img id="m-icon" src="" alt="">
            <p id="m-text" style="color:#666; line-height:1.6;"></p>
            <button id="closeBtn" class="close-btn" onclick="closeModal()">å¼€å¿ƒæ”¶ä¸‹</button>
        </div>
    </div>

    <script>
        const winIcon = "https://cdn-icons-png.flaticon.com/512/4213/4213958.png"; 
        const loseIcons = [
            "https://cdn-icons-png.flaticon.com/512/742/742752.png", 
            "https://cdn-icons-png.flaticon.com/512/725/725099.png", 
            "https://cdn-icons-png.flaticon.com/512/742/742760.png"
        ];
        const loseButtonTexts = ["å†è¯•ä¸€æ¬¡!", "æˆ‘ä¸ä¿¡ï¼Œå†æ¥!", "å“¼ï¼Œç»§ç»­æŠ½!", "å¥½è¿åœ¨åé¢!"];
        const hintButtonText = "æ„Ÿè§‰å¤§å¥–å°±åœ¨å‰é¢...";

        let count = 0; let rotation = 0;
        const spinner = document.getElementById('spinner');
        const btn = document.getElementById('spinBtn');
        const modal = document.getElementById('modal');
        const mIcon = document.getElementById('m-icon');
        const mBtn = document.getElementById('closeBtn'); 
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        
        // --- è›‹ä»”é£æ ¼éŸ³æ•ˆæ ¸å¿ƒä»£ç  ---
        function playTick() {
            if(audioCtx.state==='suspended') audioCtx.resume();
            const osc = audioCtx.createOscillator(); const gain = audioCtx.createGain();
            
            // ä½¿ç”¨æ­£å¼¦æ³¢ï¼Œå£°éŸ³æ›´åœ†æ¶¦å¯çˆ±ï¼Œåƒç©å…·æ°”æ³¡
            osc.type = 'sine';
            
            // é¢‘ç‡æ›´é«˜ï¼Œä¸”å¿«é€Ÿä¸‹é™ï¼Œæ¨¡æ‹Ÿâ€œå•¾â€æˆ–â€œå•µâ€çš„å£°éŸ³
            // ä» 1200Hz å¿«é€Ÿé™åˆ° 200Hz
            osc.frequency.setValueAtTime(1200, audioCtx.currentTime);
            osc.frequency.exponentialRampToValueAtTime(200, audioCtx.currentTime + 0.1);
            
            // éŸ³é‡åŒ…ç»œï¼šçŸ­ä¿ƒæœ‰åŠ›
            gain.gain.setValueAtTime(0.5, audioCtx.currentTime);
            gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.1);
            
            osc.connect(gain); gain.connect(audioCtx.destination);
            osc.start(); osc.stop(audioCtx.currentTime + 0.1);
        }

        // --- é—ªäº®ç™»åœºéŸ³æ•ˆ (Bling Bling) ---
        function playWinSound() {
            if(audioCtx.state === 'suspended') audioCtx.resume();
            const now = audioCtx.currentTime;
            // é—ªäº®çš„éŸ³é˜¶ (é«˜é¢‘ç¢éŸ³)
            const notes = [1046.50, 1318.51, 1567.98, 2093.00, 2637.02, 3135.96]; 

            notes.forEach((freq, i) => {
                const osc = audioCtx.createOscillator();
                const gain = audioCtx.createGain();
                osc.type = 'sine'; 
                osc.frequency.value = freq;

                const start = now + (i * 0.08); // å¿«é€Ÿè¿ç»­æ’­æ”¾
                gain.gain.setValueAtTime(0, start);
                gain.gain.linearRampToValueAtTime(0.3, start + 0.02);
                gain.gain.exponentialRampToValueAtTime(0.01, start + 0.8);

                osc.connect(gain); gain.connect(audioCtx.destination);
                osc.start(start); osc.stop(start + 0.8);
            });
        }

        function playLoseSound() {
            const osc = audioCtx.createOscillator(); const gain = audioCtx.createGain();
            osc.type = 'sawtooth'; // é”¯é½¿æ³¢ï¼Œæ¯”è¾ƒç²—ç³™ï¼Œé€‚åˆå¤±è´¥éŸ³æ•ˆ
            osc.frequency.setValueAtTime(150, audioCtx.currentTime);
            osc.frequency.linearRampToValueAtTime(100, audioCtx.currentTime+0.3);
            gain.gain.setValueAtTime(0.2, audioCtx.currentTime);
            gain.gain.linearRampToValueAtTime(0.01, audioCtx.currentTime+0.3);
            osc.connect(gain); gain.connect(audioCtx.destination);
            osc.start(); osc.stop(audioCtx.currentTime+0.3);
        }

        function easeOutCubic(t) { return 1 - Math.pow(1 - t, 3); }

        function startSpin() {
            count++; btn.disabled = true; btn.innerText = "å¥½è¿æµè½¬ä¸­...";
            let target; let isWin = false;
            if(count <= 4) { target = 210; isWin = false; } else { target = 90; isWin = true; }

            let circle = 360 * 6; let offset = -target;
            const startRotation = rotation; 
            const finalRotation = rotation + circle + offset - (rotation % 360);
            rotation = finalRotation;

            const duration = 4000; let startTime = null;
            let lastSoundIndex = Math.floor(startRotation / 60); 

            function animate(timestamp) {
                if (!startTime) startTime = timestamp;
                const elapsed = timestamp - startTime;
                const progress = Math.min(elapsed / duration, 1); 
                const ease = easeOutCubic(progress);
                const currentAngle = startRotation + (finalRotation - startRotation) * ease;
                spinner.style.transform = `rotate(${currentAngle}deg)`;
                
                const currentSoundIndex = Math.floor(currentAngle / 60);
                if (currentSoundIndex > lastSoundIndex) {
                    playTick(); lastSoundIndex = currentSoundIndex;
                }
                if (progress < 1) { requestAnimationFrame(animate); } else { finishSpin(isWin); }
            }
            requestAnimationFrame(animate);
        }

        function finishSpin(isWin) {
            if(isWin) {
                playWinSound(); // é—ªäº®éŸ³æ•ˆ
                document.getElementById('m-title').innerText = "ğŸ‰ ä¸­å¤§å¥–å•¦ï¼";
                document.getElementById('m-title').style.color = "#FF2D55";
                mIcon.src = winIcon; mIcon.className = "anim-win"; 
                document.getElementById('m-text').innerHTML = "å¤©å‘ï¼ä½ æŠ½ä¸­äº†ã€ç¥ç§˜å¤§å¥–ã€‘ï¼<br><strong>å¿«é—®è€å…¬æ˜¯ä»€ä¹ˆï¼</strong><br>(ç¤¼ç‰©å±äºä½ å•¦)";
                mBtn.innerText = "å¼€å¿ƒæ”¶ä¸‹"; mBtn.style.background = "#FF2D55";
                btn.innerText = "å†æ¬¡å›å‘³ä¸­å¥–ç¬é—´ â¤ï¸"; btn.style.background = "#34C759";
            } else {
                playLoseSound();
                document.getElementById('m-title').innerText = "é—æ†¾ç¦»åœº...";
                document.getElementById('m-title').style.color = "#666";
                const randomIcon = loseIcons[Math.floor(Math.random() * loseIcons.length)];
                mIcon.src = randomIcon; mIcon.className = "anim-lose"; 
                document.getElementById('m-text').innerHTML = "å“å‘€ï¼ä»€ä¹ˆéƒ½æ²¡æœ‰æŠ½åˆ°ï¼<br><strong>è€å©†å¤§äºº</strong>ï¼Œå†è¯•ä¸€æ¬¡ï¼Œæ‰‹æ°”åœ¨åé¢ï¼";
                
                if (count < 4) {
                    const randomText = loseButtonTexts[Math.floor(Math.random() * loseButtonTexts.length)];
                    mBtn.innerText = randomText; mBtn.style.background = "#007AFF"; 
                } else {
                    mBtn.innerText = hintButtonText; mBtn.style.background = "#5856D6"; 
                }
                btn.innerText = `å†æŠ½ä¸€æ¬¡ (ç¬¬ ${count+1} æ¬¡)`; btn.style.background = "#007AFF";
            }
            modal.style.display = 'flex'; btn.disabled = false;
        }
        function closeModal() { modal.style.display = 'none'; }
    </script>
</body>
</html>
